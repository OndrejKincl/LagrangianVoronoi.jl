<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example 3: Sedov Blast · LagrangianVoronoi.jl</title><meta name="title" content="Example 3: Sedov Blast · LagrangianVoronoi.jl"/><meta property="og:title" content="Example 3: Sedov Blast · LagrangianVoronoi.jl"/><meta property="twitter:title" content="Example 3: Sedov Blast · LagrangianVoronoi.jl"/><meta name="description" content="Documentation for LagrangianVoronoi.jl."/><meta property="og:description" content="Documentation for LagrangianVoronoi.jl."/><meta property="twitter:description" content="Documentation for LagrangianVoronoi.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">LagrangianVoronoi.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="gresho.html">Example 1: Gresho Vortex Benchmark</a></li><li><a class="tocitem" href="cavity.html">Example 2: Lid-driven cavity</a></li><li class="is-active"><a class="tocitem" href="sedov.html">Example 3: Sedov Blast</a></li><li><a class="tocitem" href="doubleshear.html">Example 4: Double Shear Layer</a></li><li><a class="tocitem" href="rayleightaylor.html">Example 5: Rayleigh-Taylor Instability</a></li><li><a class="tocitem" href="triplepoint.html">Example 6: Triple-point problem</a></li><li><a class="tocitem" href="heat.html">Example 7: Rayleigh-Bénard Instability</a></li><li><a class="tocitem" href="taylorgreen.html">Example 8: Taylor-Green Vortex</a></li><li><a class="tocitem" href="piston.html">Example 8: Saltzman piston test</a></li><li><a class="tocitem" href="cpatch.html">Example 9: Circular patch problem</a></li><li><a class="tocitem" href="dambreak.html">Example 10: Dam break</a></li><li><a class="tocitem" href="rotsquare.html">Example 11: Rotating square</a></li><li><a class="tocitem" href="bubble.html">Example 12: Rising bubble</a></li></ul></li><li><a class="tocitem" href="../api.html">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="sedov.html">Example 3: Sedov Blast</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="sedov.html">Example 3: Sedov Blast</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/OndrejKincl/LagrangianVoronoi.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/OndrejKincl/LagrangianVoronoi.jl/blob/master/docs/src/examples/sedov.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-3:-Sedov-Blast"><a class="docs-heading-anchor" href="#Example-3:-Sedov-Blast">Example 3: Sedov Blast</a><a id="Example-3:-Sedov-Blast-1"></a><a class="docs-heading-anchor-permalink" href="#Example-3:-Sedov-Blast" title="Permalink"></a></h1>    <img src='../assets/sedov.png' alt='missing' width="50%" height="50%" /><br><p>The Sedov Blast was invented in 1940s as a mathematical model of nuclear explosion. The setup is very simple: initialize a large amount of energy concentrated in a small volume and see how it expands in all directions faster than speed of sound. One has a semi-analytical solution for this problem which you can find from Rankine-Hugeniot jump conditions. (The solution is not analaytic per se because you still need to solve an ODE numerically.) There is a nice <a href="https://www.sciencedirect.com/book/9781483200880/similarity-and-dimensional-methods-in-mechanics">book</a> about the subject.</p><pre><code class="language-julia hljs">module sedov
include(&quot;../src/LagrangianVoronoi.jl&quot;)
using .LagrangianVoronoi, WriteVTK, LinearAlgebra
using LaTeXStrings, DataFrames, CSV, Plots, Measures</code></pre><p>Define constant parameters. Changing them will alter the result and you will no longer get agreement with the reference. Use <code>examples/reference/sedov.jl</code> to generate a reference for different setup. An interesting aspect of the dynamics is that large density in the wake is followed by near vacuum around the ground zero. The adiabatic index <code>gamma</code> is connected to the peak density by</p><p><span>$\frac{\rho_\mathrm{max}}{\rho_0} = \frac{\gamma + 1}{\gamma - 1}$</span>`</p><p>so for <span>$\gamma = 1.4$</span> and <span>$\rho_0 = 1$</span>, the density near the blast wave will jump from 1 to 6.</p><p>In the mathematical dream world, the process begins with a singularity of energy at <span>$t=0$</span>. But this is impossible to do numerically (and physically as well). Thus, we initially prescribe a small radius <code>r_bomb</code> of energy <code>E_bomb</code>. To be consistent with the analytical solution, we start our clock with <code>t = t_bomb</code>, where <code>t_bomb</code> is determined from a mathematical formula below.</p><pre><code class="language-julia hljs">const rho0 = 1.0
const xlims = (-1.0, 1.0)
const ylims = (-1.0, 1.0)
const N = 50 # resolution
const dr = 1.0/N
const nframes = 100
const gamma = 1.4
const P0 = 1e-8 # the background pressure (should be close to 0)
const c0 = sqrt(gamma*P0/rho0)  # sound speed
const r_bomb = 0.05 # the initial blast radius
const E_bomb = 0.3 # yeild energy of the bomb
const t_bomb = sqrt(rho0/E_bomb*r_bomb^5) # the initial time of the simulation
const t_end = 1.0
const CFL = 0.1
const export_path = &quot;results/sedov&quot;

function ic!(p::VoronoiPolygon)
    p.rho = rho0
    p.mass = p.rho*area(p)
    p.P = P0
    p.e = 0.5*norm_squared(p.v) + p.P/(p.rho*(gamma - 1.0))
end</code></pre><p>This function detonates the bomb by assigning huge over-pressure to all cells withing the radius <code>r_bomb</code>.</p><pre><code class="language-julia hljs">function detonate_bomb!(grid::VoronoiGrid)
    A_bomb = 0.0
    for p in grid.polygons
        r = norm(p.x)
        if r &lt; r_bomb
            A_bomb += area(p)
        end
    end
    P_bomb = (gamma-1.0)*E_bomb/A_bomb
    for p in grid.polygons
        r = norm(p.x)
        if r &lt; r_bomb
            p.P = P_bomb
            p.e = 0.5*norm_squared(p.v) + p.P/(p.rho*(gamma - 1.0))
        end
    end
end</code></pre><p>This time, we shall use variable time step. It should be smallest in the inital phase of the simulation when the blast travels at huge speed. For that reason, we include time global variable <code>t</code> and we shall write our own time-marching loop.</p><pre><code class="language-julia hljs">mutable struct Simulation &lt;: SimulationWorkspace
    grid::GridNS
    solver::PressureSolver
    E::Float64
    S::Float64
    t::Float64
    Simulation() = begin
        domain = Rectangle(xlims = xlims, ylims = ylims)
        grid = GridNS(domain, dr)
        populate_hex!(grid, ic! = ic!)
        detonate_bomb!(grid)
        solver = PressureSolver(grid)
        return new(grid, solver, 0.0, 0.0, t_bomb)
    end
end

function step!(sim::Simulation)
    v_shock = 0.4*sim.t^(-0.6)*(E_bomb/rho0)^0.2
    dt = CFL*dr/(sqrt(6.0)*v_shock)
    move!(sim.grid, dt)
    ideal_eos!(sim.grid, gamma; Pmin = P0)
    find_pressure!(sim.solver, dt)
    pressure_step!(sim.grid, dt)
    find_D!(sim.grid)
    viscous_step!(sim.grid, dt)
    find_dv!(sim.grid, dt)
    relaxation_step!(sim.grid, dt)
    sim.t += dt
    return
end</code></pre><p>Let us plot the total energy and entropy.</p><pre><code class="language-julia hljs">function postproc!(sim::Simulation)
    sim.E = 0.0
    sim.S = 0.0
    for p in sim.grid.polygons
        sim.E += p.mass*p.e
        sim.S += p.mass*log(abs(p.P/abs(p.rho)^gamma))
    end
    println(&quot;t = $(sim.t)&quot;)
    println(&quot;energy = $(sim.E)&quot;)
    println(&quot;entropy = $(sim.S)&quot;)
    println()
end</code></pre><p>We write our own time-marching loop and handle the file export manually. Once the simulation ends, we plot the density profile along the radial line and compare with the refence solution.</p><pre><code class="language-julia hljs">function main()
    if !ispath(export_path)
        mkpath(export_path)
        @info &quot;created a new path: $(export_path)&quot;
    end
    pvd_c = paraview_collection(joinpath(export_path, &quot;cells.pvd&quot;))
    pvd_p = paraview_collection(joinpath(export_path, &quot;points.pvd&quot;))
    nframe = 0
    sim = Simulation()
    milestones = collect(range(t_end, t_bomb, nframes)) # save the data here
    vtp_vars = (:rho, :v, :e, :P)
    while sim.t &lt; t_end
        step!(sim)
        if sim.t &gt; milestones[end]
            @show sim.t
            postproc!(sim)
            println()
            filename= joinpath(export_path, &quot;cframe$(nframe).vtp&quot;)
            pvd_c[sim.t] = export_grid(sim.grid, filename, vtp_vars...)
            filename= joinpath(export_path, &quot;pframe$(nframe).vtp&quot;)
            pvd_p[sim.t] = export_points(sim.grid, filename, vtp_vars...)
            pop!(milestones)
            nframe += 1
        end
    end
    vtk_save(pvd_c)
    vtk_save(pvd_p)
    x = Float64[]
    rho = Float64[]
    for p in sim.grid.polygons
        push!(x, norm(p.x))
        push!(rho, p.rho)
    end
    csv_data = DataFrame(x=x, rho=rho)
	CSV.write(string(export_path, &quot;/linedata.csv&quot;), csv_data)
    plotdata()
end

function plotdata()
    csv_data = CSV.read(string(export_path, &quot;/linedata.csv&quot;), DataFrame)
    csv_ref = CSV.read(&quot;reference/sedov.csv&quot;, DataFrame)
    plt = scatter(
        csv_data.x,
        csv_data.rho,
        xlabel = L&quot;x&quot;,
        ylabel = L&quot;rho&quot;,
        label = &quot;density&quot;,
        color = :red,
        markeralpha = 0.5,
        bottom_margin = 5mm,
        markersize = 1,
        markerstrokewidth=0,
    )
    plot!(
        plt,
        csv_ref.r,
        csv_ref.rho,
        label = &quot;analytic&quot;,
        color = :blue,
        linewidth = 2
    )
    savefig(plt, string(export_path, &quot;/density.pdf&quot;))
    return
end


if abspath(PROGRAM_FILE) == @__FILE__
    main()
end

end</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="cavity.html">« Example 2: Lid-driven cavity</a><a class="docs-footer-nextpage" href="doubleshear.html">Example 4: Double Shear Layer »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 19 December 2024 10:53">Thursday 19 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
